from nvd_parser import parse_nvd_data
import requests
from bs4 import BeautifulSoup


def detect_vulnerabilities(scanned_system, nvd_data):
    detected_vulnerabilities = []

    for vulnerability in nvd_data:
        cve_id = vulnerability['cve_id']

        # Check if the CVE ID is present in the scanned system
        if cve_id in scanned_system['vulnerabilities']:
            detected_vulnerabilities.append({
                'cve_id': cve_id,
                'description': vulnerability['description'],
                # Add more details
            })

    return detected_vulnerabilities


if __name__ == "__main__":

    scanned_system = {'vulnerabilities': ['CVE-2022-1234', 'CVE-2022-5678']}

    # Use the parsed NVD data obtained from the previous step
    nvd_data = parse_nvd_data("/home/dogukan/nvdcve-1.1-modified.json")  # Replace with the actual path

    detected_vulnerabilities = detect_vulnerabilities(scanned_system, nvd_data)

    # Print detected vulnerabilities
    print("Detected Vulnerabilities:")
    for vulnerability in detected_vulnerabilities:
        print(f"CVE ID: {vulnerability['cve_id']}")
        print(f"Description: {vulnerability['description']}")
        print("-" * 50)
        print("Scanned System CVEs:", scanned_system['vulnerabilities'])
        print("NVD Data CVEs:")
    for vulnerability in nvd_data:
    	print(vulnerability['cve_id'])



    

